<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Brandon's Calculator - Express Mode</title>

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:wght@300;400;600&family=Montserrat:wght@400;500;600;700&family=Poppins:wght@600;700;800&display=swap"
      rel="stylesheet"
    />

    <!-- Styles -->
    <link rel="stylesheet" href="styles.css" />

    <!-- Icons -->
    <link rel="icon" href="/icons/favicon.ico" sizes="any" />

    <!-- Supabase credentials (fill these values) -->
    <meta name="supabase-url" content="" />
    <meta name="supabase-anon-key" content="" />

    <!-- Supabase -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

    <!-- Google Maps API (loaded dynamically from meta tag or config) -->
    <script>
      // Will be loaded dynamically after getting API key from meta tags or Supabase
    </script>
  </head>
  <body>
    <!-- App Header with Customer Profile -->
    <header class="app-header"></header>

    <!-- Wizard Container -->
    <div class="wizard-container">
      <!-- Quick Entry Mode (Single Page) -->
      <div class="quick-entry-mode" id="quick-entry-mode">
        <!-- Main Container -->
        <div class="quick-entry-grid">
          <!-- Center Column: Inputs -->
          <div class="quick-entry-inputs">
            <!-- Section: Location & Vehicle -->
            <div class="quick-section">
              <h3 class="quick-section__title">Location & Vehicle</h3>

              <div class="form-group">
                <label class="form-label" for="quick-location"
                  >Your Location</label
                >
                <div class="input-with-icon">
                  <svg
                    class="input-with-icon__icon"
                    fill="none"
                    stroke="currentColor"
                    viewBox="0 0 24 24"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                      d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"
                    ></path>
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                      d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"
                    ></path>
                  </svg>
                  <input
                    type="text"
                    id="quick-location"
                    class="form-input"
                    placeholder="Enter your address or ZIP code..."
                    autocomplete="off"
                  />
                </div>
              </div>

              <div class="form-group">
                <label class="form-label" for="quick-vin"
                  >VIN or Search Saved Vehicles</label
                >
                <div class="vin-autocomplete">
                  <div class="input-with-icon">
                    <svg
                      class="input-with-icon__icon"
                      fill="none"
                      stroke="currentColor"
                      viewBox="0 0 24 24"
                    >
                      <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        stroke-width="2"
                        d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"
                      ></path>
                    </svg>
                    <input
                      type="text"
                      id="quick-vin"
                      class="form-input"
                      placeholder="Paste VIN or select saved vehicle..."
                      autocomplete="off"
                    />
                  </div>
                  <div
                    id="quick-saved-vehicles-dropdown"
                    class="saved-vehicles-dropdown"
                    style="display: none"
                  ></div>
                </div>
              </div>

              <div
                id="quick-vehicle-display"
                class="your-vehicle-section"
                style="display: none"
              >
                <div id="quick-vehicle-card" class="your-vehicle-card"></div>

                <!-- Dealer Map -->
                <div
                  id="quick-dealer-map-container"
                  class="mapCanvas"
                  style="display: none; margin-top: 1rem"
                >
                  <div
                    id="quick-dealer-map"
                    class="mapCanvas"
                    role="application"
                    aria-label="Driving directions to dealer"
                    style="height: 300px; border-radius: 8px"
                  ></div>
                </div>
              </div>
            </div>

            <!-- Section: Financing -->
            <div class="quick-section">
              <h3 class="quick-section__title">Financing Details</h3>

              <!-- Hidden inputs for slider integration -->
              <input type="hidden" id="quick-vehicle-price" />
              <input type="hidden" id="quick-down-payment" />

              <div class="form-group">
                <label class="form-label" for="lender-select"
                  >Preferred Lender</label
                >
                <select id="lender-select" class="form-select">
                  <option value="lowest">Lowest Price by APR</option>
                </select>
                <div
                  class="form-hint"
                  id="lender-effective-date"
                  style="
                    display: none;
                    margin-top: 4px;
                    font-size: 11px;
                    color: #64748b;
                  "
                >
                  Rates effective:
                  <span id="lender-effective-date-value">--</span>
                </div>
              </div>

              <div class="form-group">
                <label class="form-label" for="quick-loan-term"
                  >Loan Term</label
                >
                <select id="quick-loan-term" class="form-select">
                  <option value="">Select Term</option>
                  <option value="36">36 months (3 years)</option>
                  <option value="48">48 months (4 years)</option>
                  <option value="60">60 months (5 years)</option>
                  <option value="72" selected>72 months (6 years)</option>
                  <option value="84">84 months (7 years)</option>
                </select>
              </div>

              <div class="form-group">
                <label class="form-label" for="quick-credit-score"
                  >Credit Score Range</label
                >
                <select id="quick-credit-score" class="form-select">
                  <option value="">Select Range</option>
                  <option value="excellent" selected>Excellent (750+)</option>
                  <option value="good">Good (700-749)</option>
                  <option value="fair">Fair (650-699)</option>
                  <option value="poor">Building Credit (&lt; 650)</option>
                </select>
              </div>
            </div>

          </div>

          <!-- Right Column: Live Summary with Sliders -->
          <div class="quick-entry-summary">
            <div class="quick-summary-sticky">
              <!-- Monthly Payment Hero -->
              <div class="quick-summary-hero">
                <div class="quick-summary-hero__label">
                  Estimated Monthly Payment
                </div>
                <div class="quick-summary-hero__value" id="quickMonthlyPayment">
                  $0.00
                </div>
                <div class="quick-summary-hero__meta">
                  <span id="quickTerm">0 months</span>
                  <span>•</span>
                  <span id="quickAPR">--%</span>
                </div>
                <div
                  class="quick-summary-hero__lender"
                  id="quickLenderInfo"
                  style="display: none"
                >
                  <span id="quickLenderName">--</span>
                  <span
                    class="quick-summary-hero__lender-separator"
                    id="quickLenderDateSeparator"
                    style="display: none"
                  >
                    •
                  </span>
                  <span
                    class="quick-summary-hero__lender-date"
                    id="quickLenderDate"
                    >Rates Effective:</span
                  >
                </div>
                <!-- Custom APR Badge -->
                <div
                  class="quick-summary-hero__custom-apr-badge"
                  id="quickCustomAprBadge"
                  style="display: none"
                >
                  <svg
                    width="12"
                    height="12"
                    viewBox="0 0 12 12"
                    fill="currentColor"
                    style="margin-right: 4px"
                  >
                    <path
                      d="M6 1L7.5 4.5L11 5L8.5 7.5L9 11L6 9L3 11L3.5 7.5L1 5L4.5 4.5L6 1Z"
                      fill="currentColor"
                    />
                  </svg>
                  <span>User Defined APR</span>
                </div>
              </div>

              <!-- TIL Disclosures -->
              <div class="quick-til-disclosures">
                <h4 class="quick-til-title">Truth-in-Lending Disclosures</h4>
                <div class="quick-til-grid">
                  <div class="quick-til-card" style="position: relative">
                    <div class="quick-til-label">Annual Percentage Rate</div>
                    <div class="quick-til-value-wrapper">
                      <button
                        type="button"
                        class="til-arrow til-arrow--left"
                        id="aprArrowLeft"
                        aria-label="Decrease APR by 0.01%"
                      >
                        <svg
                          width="8"
                          height="12"
                          viewBox="0 0 8 12"
                          fill="currentColor"
                        >
                          <path
                            d="M7 1L2 6L7 11"
                            stroke="currentColor"
                            stroke-width="2"
                            fill="none"
                            stroke-linecap="round"
                            stroke-linejoin="round"
                          />
                        </svg>
                      </button>
                      <div
                        class="quick-til-value til-editable"
                        id="quickTilAPR"
                        tabindex="0"
                      >
                        --%
                      </div>
                      <button
                        type="button"
                        class="til-arrow til-arrow--right"
                        id="aprArrowRight"
                        aria-label="Increase APR by 0.01%"
                      >
                        <svg
                          width="8"
                          height="12"
                          viewBox="0 0 8 12"
                          fill="currentColor"
                        >
                          <path
                            d="M1 1L6 6L1 11"
                            stroke="currentColor"
                            stroke-width="2"
                            fill="none"
                            stroke-linecap="round"
                            stroke-linejoin="round"
                          />
                        </svg>
                      </button>
                    </div>
                    <div class="quick-til-note">
                      Cost of credit as yearly rate
                    </div>
                    <!-- APR Tooltip -->
                    <div
                      class="apr-tooltip"
                      id="aprTooltip"
                      style="display: none"
                    >
                      <div class="apr-tooltip__payment" id="aprTooltipPayment">
                        $0/mo
                      </div>
                      <div class="apr-tooltip__diff" id="aprTooltipDiff">
                        +$0/mo from original
                      </div>
                    </div>
                  </div>
                  <div class="quick-til-card">
                    <div class="quick-til-label">Term (Months)</div>
                    <div class="quick-til-value-wrapper">
                      <button
                        type="button"
                        class="til-arrow til-arrow--left"
                        id="termArrowLeft"
                        aria-label="Decrease term by 6 months"
                      >
                        <svg
                          width="8"
                          height="12"
                          viewBox="0 0 8 12"
                          fill="currentColor"
                        >
                          <path
                            d="M7 1L2 6L7 11"
                            stroke="currentColor"
                            stroke-width="2"
                            fill="none"
                            stroke-linecap="round"
                            stroke-linejoin="round"
                          />
                        </svg>
                      </button>
                      <div
                        class="quick-til-value til-editable"
                        id="quickTilTerm"
                        tabindex="0"
                      >
                        72
                      </div>
                      <button
                        type="button"
                        class="til-arrow til-arrow--right"
                        id="termArrowRight"
                        aria-label="Increase term by 6 months"
                      >
                        <svg
                          width="8"
                          height="12"
                          viewBox="0 0 8 12"
                          fill="currentColor"
                        >
                          <path
                            d="M1 1L6 6L1 11"
                            stroke="currentColor"
                            stroke-width="2"
                            fill="none"
                            stroke-linecap="round"
                            stroke-linejoin="round"
                          />
                        </svg>
                      </button>
                    </div>
                    <div class="quick-til-note">Length of loan</div>
                    <!-- Term Tooltip -->
                    <div
                      class="apr-tooltip"
                      id="termTooltip"
                      style="display: none"
                    >
                      <div class="apr-tooltip__payment" id="termTooltipPayment">
                        $0/mo
                      </div>
                      <div class="apr-tooltip__diff" id="termTooltipDiff">
                        +$0/mo from original
                      </div>
                    </div>
                  </div>
                  <div class="quick-til-card">
                    <div class="quick-til-label">Finance Charge</div>
                    <div class="quick-til-value" id="quickTilFinanceCharge">
                      $0.00
                    </div>
                    <div class="quick-til-note">Dollar cost of credit</div>
                    <!-- Finance Charge Tooltip (shown when APR is being adjusted) -->
                    <div
                      class="finance-charge-tooltip"
                      id="financeChargeTooltip"
                      style="display: none"
                    >
                      <div
                        class="finance-charge-tooltip__diff"
                        id="financeChargeTooltipDiff"
                      >
                        +$0
                      </div>
                    </div>
                  </div>
                  <div class="quick-til-card">
                    <div class="quick-til-label">Amount Financed</div>
                    <div class="quick-til-value" id="quickTilAmountFinanced">
                      $0.00
                    </div>
                    <div class="quick-til-note">Credit provided to you</div>
                  </div>
                  <div class="quick-til-card">
                    <div class="quick-til-label">Total of Payments</div>
                    <div class="quick-til-value" id="quickTilTotalPayments">
                      $0.00
                    </div>
                    <div class="quick-til-note">Total after all payments</div>
                  </div>
                  <div class="quick-til-card">
                    <div class="quick-til-label">Monthly Finance Charge</div>
                    <div
                      class="quick-til-value"
                      id="quickTilMonthlyFinanceCharge"
                    >
                      $0.00
                    </div>
                    <div class="quick-til-note">Interest portion per month</div>
                    <!-- Monthly Finance Charge Tooltip -->
                    <div
                      class="apr-tooltip"
                      id="monthlyFinanceChargeTooltip"
                      style="display: none"
                    >
                      <div
                        class="apr-tooltip__payment"
                        id="monthlyFinanceChargeTooltipAmount"
                      >
                        $0/mo
                      </div>
                      <div
                        class="apr-tooltip__diff"
                        id="monthlyFinanceChargeTooltipDiff"
                      >
                        +$0/mo from original
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Adjust Your Numbers Section -->
              <div class="card adjust-numbers-card">
                <div class="adjust-numbers-header">
                  <h3>Adjust Your Numbers</h3>
                  <button
                    type="button"
                    onclick="openFeesModal()"
                    class="btn-edit-fees"
                  >
                    <svg
                      width="14"
                      height="14"
                      viewBox="0 0 24 24"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="2"
                    >
                      <path
                        d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"
                      ></path>
                      <path
                        d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"
                      ></path>
                    </svg>
                    Edit Fees & Taxes
                  </button>
                </div>

                <div class="quick-adjustments-list">
                  <!-- Sale Price Slider -->
                  <div class="quick-adjustment">
                    <div
                      class="quick-adjustment__hover-ribbon"
                      id="ribbonSalePrice"
                    >
                      $0/mo
                    </div>
                    <div class="quick-adjustment-label">Sale Price</div>
                    <div class="quick-slider-control slider-row">
                      <input
                        type="range"
                        class="quick-slider"
                        id="quickSliderSalePrice"
                        min="0"
                        max="150000"
                        step="100"
                      />
                      <div class="quick-value-wrapper">
                        <input
                          type="text"
                          class="quick-value-input"
                          id="quickInputSalePrice"
                        />
                        <div
                          class="quick-diff-indicator"
                          id="quickDiffSalePrice"
                          style="display: none"
                        ></div>
                        <button
                          type="button"
                          class="quick-reset-btn"
                          id="quickResetSalePrice"
                          style="display: none"
                          title="Reset to original"
                        >
                          ↺
                        </button>
                      </div>
                    </div>
                  </div>

                  <!-- Cash Down Slider -->
                  <div class="quick-adjustment">
                    <div
                      class="quick-adjustment__hover-ribbon"
                      id="ribbonCashDown"
                    >
                      $0/mo
                    </div>
                    <div class="quick-adjustment-label">Cash Down</div>
                    <div class="quick-slider-control slider-row">
                      <input
                        type="range"
                        class="quick-slider"
                        id="quickSliderCashDown"
                        min="0"
                        max="50000"
                        step="100"
                      />
                      <div class="quick-value-wrapper">
                        <input
                          type="text"
                          class="quick-value-input"
                          id="quickInputCashDown"
                        />
                        <div
                          class="quick-diff-indicator"
                          id="quickDiffCashDown"
                          style="display: none"
                        ></div>
                        <button
                          type="button"
                          class="quick-reset-btn"
                          id="quickResetCashDown"
                          style="display: none"
                          title="Reset to original"
                        >
                          ↺
                        </button>
                      </div>
                    </div>
                  </div>

                  <!-- Trade Allowance Slider -->
                  <div class="quick-adjustment">
                    <div
                      class="quick-adjustment__hover-ribbon"
                      id="ribbonTradeAllowance"
                    >
                      $0/mo
                    </div>
                    <div class="quick-adjustment-label">Trade-In Allowance</div>
                    <div class="quick-slider-control slider-row">
                      <input
                        type="range"
                        class="quick-slider"
                        id="quickSliderTradeAllowance"
                        min="0"
                        max="75000"
                        step="100"
                      />
                      <div class="quick-value-wrapper">
                        <input
                          type="text"
                          class="quick-value-input"
                          id="quickInputTradeAllowance"
                        />
                        <div
                          class="quick-diff-indicator"
                          id="quickDiffTradeAllowance"
                          style="display: none"
                        ></div>
                        <button
                          type="button"
                          class="quick-reset-btn"
                          id="quickResetTradeAllowance"
                          style="display: none"
                          title="Reset to original"
                        >
                          ↺
                        </button>
                      </div>
                    </div>
                  </div>

                  <!-- Trade Payoff Slider -->
                  <div class="quick-adjustment">
                    <div
                      class="quick-adjustment__hover-ribbon"
                      id="ribbonTradePayoff"
                    >
                      $0/mo
                    </div>
                    <div class="quick-adjustment-label">Trade-In Payoff</div>
                    <div class="quick-slider-control slider-row">
                      <input
                        type="range"
                        class="quick-slider"
                        id="quickSliderTradePayoff"
                        min="0"
                        max="75000"
                        step="100"
                      />
                      <div class="quick-value-wrapper">
                        <input
                          type="text"
                          class="quick-value-input"
                          id="quickInputTradePayoff"
                        />
                        <div
                          class="quick-diff-indicator"
                          id="quickDiffTradePayoff"
                          style="display: none"
                        ></div>
                        <button
                          type="button"
                          class="quick-reset-btn"
                          id="quickResetTradePayoff"
                          style="display: none"
                          title="Reset to original"
                        >
                          ↺
                        </button>
                      </div>
                    </div>
                  </div>

                  <!-- Dealer Fees Slider -->
                  <div class="quick-adjustment">
                    <div
                      class="quick-adjustment__hover-ribbon"
                      id="ribbonDealerFees"
                    >
                      $0/mo
                    </div>
                    <div class="quick-adjustment-label">Total Dealer Fees</div>
                    <div class="quick-slider-control slider-row">
                      <input
                        type="range"
                        class="quick-slider"
                        id="quickSliderDealerFees"
                        min="0"
                        max="10000"
                        step="100"
                      />
                      <div class="quick-value-wrapper">
                        <input
                          type="text"
                          class="quick-value-input"
                          id="quickInputDealerFees"
                        />
                        <div
                          class="quick-diff-indicator"
                          id="quickDiffDealerFees"
                          style="display: none"
                        ></div>
                        <button
                          type="button"
                          class="quick-reset-btn"
                          id="quickResetDealerFees"
                          style="display: none"
                          title="Reset to original"
                        >
                          ↺
                        </button>
                      </div>
                    </div>
                  </div>

                  <!-- Customer Add-ons Slider -->
                  <div class="quick-adjustment">
                    <div
                      class="quick-adjustment__hover-ribbon"
                      id="ribbonCustomerAddons"
                    >
                      $0/mo
                    </div>
                    <div class="quick-adjustment-label">
                      Total Customer Add-ons
                    </div>
                    <div class="quick-slider-control slider-row">
                      <input
                        type="range"
                        class="quick-slider"
                        id="quickSliderCustomerAddons"
                        min="0"
                        max="10000"
                        step="100"
                      />
                      <div class="quick-value-wrapper">
                        <input
                          type="text"
                          class="quick-value-input"
                          id="quickInputCustomerAddons"
                        />
                        <div
                          class="quick-diff-indicator"
                          id="quickDiffCustomerAddons"
                          style="display: none"
                        ></div>
                        <button
                          type="button"
                          class="quick-reset-btn"
                          id="quickResetCustomerAddons"
                          style="display: none"
                          title="Reset to original"
                        >
                          ↺
                        </button>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Itemization / Calculation Breakdown -->
              <div class="card itemization-card">
                <h3>Itemization of Costs</h3>

                <div class="itemization-content">
                  <!-- Sale Price -->
                  <div class="quick-item itemization-row quick-item--header">
                    <div class="quick-item-label item-label">Sale Price</div>
                    <div class="quick-item-value item-value" id="quickCalcSalePrice">
                      $0.00
                    </div>
                  </div>

                  <!-- LESS Cash Down -->
                  <div class="quick-item itemization-row quick-item--less quick-item--header">
                    <div class="quick-item-label item-label">LESS Cash Down</div>
                    <div class="quick-item-value item-value" id="quickCalcCashDown">
                      $0.00
                    </div>
                  </div>

                  <!-- LESS Net Trade-In -->
                  <div class="quick-item itemization-row quick-item--less quick-item--header">
                    <div class="quick-item-label item-label">LESS Net Trade-In</div>
                    <div class="quick-item-value item-value" id="quickNetTrade">$0.00</div>
                  </div>

                  <!-- Trade Allowance (Indented) -->
                  <div class="quick-item itemization-row quick-item--indent nested">
                    <div class="quick-item-label item-label">Trade-In Allowance</div>
                    <div class="quick-item-value item-value" id="quickCalcTradeAllowance">
                      $0.00
                    </div>
                  </div>

                  <!-- Trade Payoff (Indented) -->
                  <div class="quick-item itemization-row quick-item--indent nested">
                    <div class="quick-item-label item-label">Trade-In Payoff</div>
                    <div class="quick-item-value item-value" id="quickCalcTradePayoff">
                      $0.00
                    </div>
                  </div>

                  <!-- Unpaid Balance -->
                  <div class="quick-item itemization-row quick-item--header">
                    <div class="quick-item-label item-label">Unpaid Balance</div>
                    <div class="quick-item-value item-value" id="quickUnpaidBalance">
                      $0.00
                    </div>
                  </div>

                  <!-- PLUS Other Charges -->
                  <div class="quick-item itemization-row quick-item--plus quick-item--header">
                    <div class="quick-item-label item-label">PLUS Other Charges</div>
                    <div class="quick-item-value item-value" id="quickOtherCharges">
                      $0.00
                    </div>
                  </div>

                  <!-- Dealer Fees (Indented) -->
                  <div class="quick-item itemization-row quick-item--indent nested">
                    <div class="quick-item-label item-label">Total Dealer Fees</div>
                    <div class="quick-item-value item-value" id="quickCalcDealerFees">
                      $0.00
                    </div>
                  </div>

                  <!-- Customer Add-ons (Indented) -->
                  <div class="quick-item itemization-row quick-item--indent nested">
                    <div class="quick-item-label item-label">Total Customer Add-ons</div>
                    <div class="quick-item-value item-value" id="quickCalcCustomerAddons">
                      $0.00
                    </div>
                  </div>

                  <!-- Gov't Fees (Indented) -->
                  <div class="quick-item itemization-row quick-item--indent nested">
                    <div class="quick-item-label item-label">Total Gov't Fees</div>
                    <div class="quick-item-value item-value" id="quickGovtFees">$0.00</div>
                  </div>

                  <!-- Sales Tax (Header) -->
                  <div class="quick-item itemization-row quick-item--header">
                    <div class="quick-item-label item-label">Sales Tax</div>
                    <div class="quick-item-value item-value" id="quickSaleTaxTotal">
                      $0.00
                    </div>
                  </div>

                  <!-- State Tax (Indented) -->
                  <div class="quick-item itemization-row quick-item--indent nested">
                    <div class="quick-item-label item-label" id="quickStateTaxLabel">
                      State Taxes
                    </div>
                    <div class="quick-item-value item-value" id="quickStateTax">$0.00</div>
                  </div>

                  <!-- County Tax (Indented) -->
                  <div class="quick-item itemization-row quick-item--indent nested">
                    <div class="quick-item-label item-label" id="quickCountyTaxLabel">
                      County Taxes
                    </div>
                    <div class="quick-item-value item-value" id="quickCountyTax">
                      $0.00
                    </div>
                 </div>

                  <!-- Amount Financed (Total) -->
                  <div class="quick-item itemization-row quick-item--total">
                    <div class="quick-item-label item-label">AMOUNT FINANCED</div>
                    <div class="quick-item-value item-value" id="quickAmountFinancedTotal">
                      $0.00
                    </div>
                  </div>

                  <!-- Divider -->
                  <div
                    style="
                      border-top: 1px solid rgba(0, 0, 0, 0.1);
                      margin: 12px 0;
                    "
                  ></div>

                  <!-- Cash Due at Signing -->
                  <div class="quick-item itemization-row quick-item--highlight">
                    <div class="quick-item-label item-label">Cash Due at Signing</div>
                    <div class="quick-item-value item-value" id="quickCashDueHighlight">
                      $0.00
                    </div>
                  </div>
                </div>
              </div>

              <!-- View Summary Button -->
              <button
                type="button"
                onclick="openReviewContractModal()"
                class="btn-review-contract"
              >
                <svg
                  width="20"
                  height="20"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                >
                  <path
                    d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"
                  ></path>
                  <polyline points="14 2 14 8 20 8"></polyline>
                  <line x1="16" y1="13" x2="8" y2="13"></line>
                  <line x1="16" y1="17" x2="8" y2="17"></line>
                  <polyline points="10 9 9 9 8 9"></polyline>
                </svg>
                View Summary
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Fees & Taxes Modal -->
    <div id="fees-modal" class="modal" style="display: none">
      <div class="modal-overlay" onclick="closeFeesModal()"></div>
      <div class="modal-content fees-modal">
        <button
          class="modal-close"
          onclick="closeFeesModal()"
          aria-label="Close"
        >
          <svg
            width="24"
            height="24"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M6 18L18 6M6 6l12 12"
            ></path>
          </svg>
        </button>

        <h3 class="modal-title">Enter Fees & Taxes</h3>
        <div class="modal-toolbar">
          <p class="modal-description">
            Tune the fees that roll into your amount financed. We’ll auto-save
            as you go.
          </p>
          <button
            type="button"
            class="modal-toolbar__action"
            id="modal-edit-fee-button"
          >
            <svg
              width="16"
              height="16"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
              aria-hidden="true"
            >
              <path
                d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"
              />
              <path
                d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"
              />
            </svg>
            Edit Fee Templates
          </button>
        </div>

        <div class="fees-modal-sections">
          <section class="fee-category" data-fee-category="dealer">
            <header class="fee-category__header">
              <div class="fee-category__heading">
                <h4>Dealer Fees</h4>
                <p class="fee-category__hint">
                  Doc fee, dealer prep, PDI, etc.
                </p>
              </div>
            </header>
            <div class="fee-category__rows" id="dealer-fee-rows"></div>
            <footer class="fee-category__footer">
              <span>Total Dealer Fees</span>
              <span class="fee-category__total" id="dealer-fee-total"
                >$0.00</span
              >
            </footer>
          </section>

          <section class="fee-category" data-fee-category="customer">
            <header class="fee-category__header">
              <div class="fee-category__heading">
                <h4>Customer Add-ons</h4>
                <p class="fee-category__hint">
                  Extended warranty, GAP, service plans, etc.
                </p>
              </div>
            </header>
            <div class="fee-category__rows" id="customer-fee-rows"></div>
            <footer class="fee-category__footer">
              <span>Total Customer Add-ons</span>
              <span class="fee-category__total" id="customer-fee-total"
                >$0.00</span
              >
            </footer>
          </section>

          <section class="fee-category" data-fee-category="gov">
            <header class="fee-category__header">
              <div class="fee-category__heading">
                <h4>Gov't Fees</h4>
                <p class="fee-category__hint">
                  Title, registration, plate transfers, etc.
                </p>
              </div>
            </header>
            <div class="fee-category__rows" id="gov-fee-rows"></div>
            <footer class="fee-category__footer">
              <span>Total Gov't Fees</span>
              <span class="fee-category__total" id="gov-fee-total">$0.00</span>
            </footer>
          </section>
        </div>

        <div class="fees-tax-block">
          <div class="fees-tax-block__header">
            <h4>Taxes</h4>
          </div>
          <div class="fees-tax-grid">
            <label class="fees-tax-grid__label" for="modal-state-tax"
              >State Tax Rate</label
            >
            <input
              type="text"
              id="modal-state-tax"
              class="form-input form-input--readonly"
              readonly
              disabled
              value="6.00"
            />
            <label class="fees-tax-grid__label" for="modal-county-tax"
              >County Tax Rate</label
            >
            <input
              type="text"
              id="modal-county-tax"
              class="form-input form-input--readonly"
              readonly
              disabled
              value="1.00"
            />
          </div>
        </div>

        <div class="fees-summary">
          <div class="fees-summary__row">
            <span>Taxes (State + County)</span>
            <span class="fees-summary__value" id="modal-tax-total">$0.00</span>
          </div>
          <div class="fees-summary__row">
            <span>Total Fees &amp; Add-ons</span>
            <span class="fees-summary__value" id="modal-fees-total">$0.00</span>
          </div>
          <div class="fees-summary__row fees-summary__row--highlight">
            <span>Other Charges (Fees + Taxes)</span>
            <span class="fees-summary__value" id="modal-other-charges"
              >$0.00</span
            >
          </div>
          <p class="fees-summary__link" style="cursor: default">
            Taxes are based on your address entered above.
          </p>
        </div>

        <div class="button-group">
          <button
            type="button"
            class="btn btn-secondary"
            onclick="closeFeesModal()"
          >
            Close
          </button>
        </div>
      </div>
    </div>

    <datalist id="dealer-fee-suggestions"></datalist>
    <datalist id="customer-fee-suggestions"></datalist>
    <datalist id="gov-fee-suggestions"></datalist>

    <!-- Edit Fee Modal -->
    <div id="edit-fee-modal" class="modal" style="display: none">
      <div class="modal-overlay" onclick="closeEditFeeModal()"></div>
      <div class="modal-content edit-fee-modal">
        <button
          class="modal-close"
          onclick="closeEditFeeModal()"
          aria-label="Close edit fee modal"
        >
          <svg
            width="24"
            height="24"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M6 18L18 6M6 6l12 12"
            ></path>
          </svg>
        </button>

        <h3 class="modal-title">Edit Fee</h3>
        <p class="modal-description">
          Update a saved fee or add a new one to your Supabase set. These
          updates will be available the next time you open this modal.
        </p>

        <form id="edit-fee-form" class="edit-fee-form">
          <div class="form-group">
            <label class="form-label" for="edit-fee-type">Fee Type</label>
            <select id="edit-fee-type" class="form-select">
              <option value="dealer">Dealer</option>
              <option value="customer">Customer</option>
              <option value="gov">Gov't</option>
            </select>
          </div>

          <div class="form-group">
            <label class="form-label" for="edit-fee-name">Description</label>
            <input
              type="text"
              id="edit-fee-name"
              class="form-input"
              list="dealer-fee-suggestions"
              placeholder="e.g., Doc Fee"
              required
            />
          </div>

          <div class="form-group">
            <label class="form-label" for="edit-fee-amount">Amount</label>
            <input
              type="text"
              id="edit-fee-amount"
              class="form-input"
              placeholder="$0.00"
              required
            />
          </div>

          <p
            class="modal-status"
            id="edit-fee-status"
            role="status"
            aria-live="polite"
          ></p>

          <div class="button-group">
            <button
              type="button"
              class="btn btn-secondary"
              onclick="closeEditFeeModal()"
            >
              Cancel
            </button>
            <button type="submit" class="btn btn-primary">Save Fee</button>
          </div>
        </form>
      </div>
    </div>

    <!-- Unavailable Vehicle Modal -->
    <div id="unavailable-vehicle-modal" class="modal" style="display: none">
      <div class="modal-overlay" onclick="closeUnavailableVehicleModal()"></div>
      <div class="modal-content unavailable-vehicle-modal">
        <button
          class="modal-close"
          onclick="closeUnavailableVehicleModal()"
          aria-label="Close"
        >
          <svg
            width="24"
            height="24"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M6 18L18 6M6 6l12 12"
            ></path>
          </svg>
        </button>

        <div class="unavailable-vehicle-icon">
          <svg
            width="64"
            height="64"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"
            ></path>
          </svg>
        </div>

        <h2 class="unavailable-vehicle-title">Vehicle No Longer Available</h2>

        <div class="unavailable-vehicle-message">
          <p>
            This vehicle has been sold or is no longer listed on MarketCheck.
          </p>
          <div
            id="unavailable-vehicle-details"
            class="unavailable-vehicle-details"
          ></div>
        </div>

        <div class="unavailable-vehicle-actions">
          <button class="btn btn-danger" onclick="removeUnavailableVehicle()">
            <svg
              width="20"
              height="20"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"
              ></path>
            </svg>
            Remove from Saved Vehicles
          </button>
          <button
            class="btn btn-secondary"
            onclick="closeUnavailableVehicleModal()"
          >
            Keep in My List
          </button>
        </div>
      </div>
    </div>

    <!-- Retail Buyers Summary Modal -->
    <!-- APR Confirmation Modal -->
    <div id="apr-confirmation-modal" class="modal" style="display: none">
      <div class="modal-overlay"></div>
      <div class="modal-content apr-confirmation-modal">
        <div class="apr-confirmation-icon">
          <svg
            width="48"
            height="48"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"
            />
          </svg>
        </div>
        <h2 class="apr-confirmation-title">Custom APR Detected</h2>
        <p class="apr-confirmation-message">
          You've adjusted the APR from the lender's rate. Would you like to:
        </p>
        <div class="apr-confirmation-details">
          <div class="apr-detail-row">
            <span class="apr-detail-label">Lender Rate:</span>
            <span class="apr-detail-value" id="aprConfirmLenderRate">--%</span>
          </div>
          <div class="apr-detail-row">
            <span class="apr-detail-label">Your Custom Rate:</span>
            <span class="apr-detail-value" id="aprConfirmCustomRate">--%</span>
          </div>
        </div>
        <div class="apr-confirmation-buttons">
          <button
            class="apr-confirmation-btn apr-confirmation-btn--reset"
            onclick="confirmAprChoice('reset')"
          >
            <svg
              width="16"
              height="16"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M3 10h10a8 8 0 018 8v2M3 10l6 6m-6-6l6-6"
              />
            </svg>
            Reset to Lender Rate
          </button>
          <button
            class="apr-confirmation-btn apr-confirmation-btn--keep"
            onclick="confirmAprChoice('keep')"
          >
            <svg
              width="16"
              height="16"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M5 13l4 4L19 7"
              />
            </svg>
            Keep Custom Rate
          </button>
        </div>
      </div>
    </div>

    <!-- Customer Profile Modal -->
    <div id="customer-profile-modal" class="modal" style="display: none">
      <div class="modal-overlay" onclick="closeCustomerProfileModal()"></div>
      <div class="modal-content customer-profile-modal">
        <button
          class="modal-close"
          onclick="closeCustomerProfileModal()"
          aria-label="Close"
        >
          <svg
            width="24"
            height="24"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M6 18L18 6M6 6l12 12"
            ></path>
          </svg>
        </button>

        <div class="customer-profile-header">
          <div class="customer-profile-icon">
            <svg
              width="48"
              height="48"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"
              ></path>
            </svg>
          </div>
          <h2 class="customer-profile-title">Customer Profile</h2>
          <p class="customer-profile-subtitle">
            Your information will be saved and auto-filled throughout the app
          </p>
        </div>

        <div class="customer-profile-body">
          <!-- Contact Information -->
          <div class="profile-section">
            <h3 class="profile-section-title">Contact Information</h3>
            <div class="form-group">
              <label class="form-label" for="profileFullName"
                >Full Name *</label
              >
              <input
                type="text"
                id="profileFullName"
                class="form-input"
                placeholder="John Smith"
                required
              />
            </div>
            <div class="form-group">
              <label class="form-label" for="profileEmail">Email *</label>
              <input
                type="email"
                id="profileEmail"
                class="form-input"
                placeholder="john.smith@email.com"
                required
              />
            </div>
            <div class="form-group">
              <label class="form-label" for="profilePhone">Phone *</label>
              <input
                type="tel"
                id="profilePhone"
                class="form-input"
                placeholder="(555) 123-4567"
                required
              />
            </div>
          </div>

          <!-- Address Information -->
          <div class="profile-section">
            <h3 class="profile-section-title">Address (Optional)</h3>
            <div class="form-group">
              <label class="form-label" for="profileAddress"
                >Home Address</label
              >
              <input
                type="text"
                id="profileAddress"
                class="form-input"
                placeholder="123 Main St"
              />
              <small class="form-hint"
                >Use Google Places autocomplete for accurate tax
                calculations</small
              >
            </div>
            <div class="form-row">
              <div class="form-group">
                <label class="form-label" for="profileCity">City</label>
                <input
                  type="text"
                  id="profileCity"
                  class="form-input"
                  placeholder="Miami"
                />
              </div>
              <div class="form-group">
                <label class="form-label" for="profileState">State</label>
                <input
                  type="text"
                  id="profileState"
                  class="form-input"
                  placeholder="FL"
                  maxlength="2"
                />
              </div>
              <div class="form-group">
                <label class="form-label" for="profileZip">ZIP Code</label>
                <input
                  type="text"
                  id="profileZip"
                  class="form-input"
                  placeholder="33101"
                  maxlength="5"
                />
              </div>
            </div>
          </div>

          <!-- Preferences -->
          <div class="profile-section">
            <h3 class="profile-section-title">Preferences</h3>
            <div class="form-group">
              <label class="form-label" for="profileCreditScore"
                >Credit Score Range</label
              >
              <select id="profileCreditScore" class="form-select">
                <option value="">Select Range</option>
                <option value="excellent">Excellent (750+)</option>
                <option value="good">Good (700-749)</option>
                <option value="fair">Fair (650-699)</option>
                <option value="poor">Poor (below 650)</option>
              </select>
            </div>
            <div class="form-group">
              <label class="form-label" for="profileDownPayment"
                >Preferred Down Payment</label
              >
              <input
                type="text"
                id="profileDownPayment"
                class="form-input currency-input"
                placeholder="$0"
              />
              <small class="form-hint">Your typical down payment amount</small>
            </div>
            <div class="form-group">
              <label class="form-label" for="profileTradeValue"
                >Typical Trade-In Value</label
              >
              <input
                type="text"
                id="profileTradeValue"
                class="form-input currency-input"
                placeholder="$0"
              />
              <small class="form-hint"
                >Expected value of your trade-in vehicle</small
              >
            </div>
            <div class="form-group">
              <label class="form-label" for="profileTradePayoff"
                >Typical Trade-In Payoff</label
              >
              <input
                type="text"
                id="profileTradePayoff"
                class="form-input currency-input"
                placeholder="$0"
              />
              <small class="form-hint"
                >Amount owed on your trade-in vehicle</small
              >
            </div>
          </div>
        </div>

        <div class="customer-profile-footer">
          <button
            type="button"
            class="btn btn-secondary"
            onclick="closeCustomerProfileModal()"
          >
            Cancel
          </button>
          <button
            type="button"
            class="btn btn-primary"
            onclick="saveCustomerProfile()"
          >
            <svg
              width="16"
              height="16"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M5 13l4 4L19 7"
              ></path>
            </svg>
            Save Profile
          </button>
        </div>
      </div>
    </div>

    <!-- My Garage Modal -->
    <div id="my-garage-modal" class="modal" style="display: none">
      <div class="modal-overlay" onclick="closeMyGarageModal()"></div>
      <div class="modal-content my-garage-modal">
        <button
          class="modal-close"
          onclick="closeMyGarageModal()"
          aria-label="Close"
        >
          <svg
            width="24"
            height="24"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M6 18L18 6M6 6l12 12"
            ></path>
          </svg>
        </button>

        <div class="garage-header">
          <div class="garage-icon">
            <svg
              width="48"
              height="48"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M19 9l-7 7-7-7"
              ></path>
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M5 12h.01M12 12h.01M19 12h.01M6 20h12a2 2 0 002-2v-5a2 2 0 00-2-2H6a2 2 0 00-2 2v5a2 2 0 002 2z"
              ></path>
            </svg>
          </div>
          <h2 class="garage-title">My Garage</h2>
          <p class="garage-subtitle">
            Manage your vehicles for quick trade-in selection
          </p>
        </div>

        <div class="garage-body">
          <!-- Vehicle List -->
          <div id="garage-vehicle-list" class="garage-vehicle-list">
            <!-- Vehicles will be dynamically inserted here -->
            <div class="garage-empty-state" id="garage-empty-state">
              <svg
                width="64"
                height="64"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
                style="margin: 0 auto 16px; opacity: 0.3"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M19 9l-7 7-7-7"
                ></path>
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M5 12h.01M12 12h.01M19 12h.01M6 20h12a2 2 0 002-2v-5a2 2 0 00-2-2H6a2 2 0 00-2 2v5a2 2 0 002 2z"
                ></path>
              </svg>
              <p>Your garage is empty</p>
              <small>Add your first vehicle to get started</small>
            </div>
          </div>

          <!-- Add Vehicle Button -->
          <button
            type="button"
            class="btn btn-primary garage-add-btn"
            onclick="showGarageForm()"
          >
            <svg
              width="20"
              height="20"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M12 4v16m8-8H4"
              ></path>
            </svg>
            Add Vehicle
          </button>

          <!-- Vehicle Form (Hidden by default) -->
          <div
            id="garage-vehicle-form"
            class="garage-vehicle-form"
            style="display: none"
          >
            <h3 class="garage-form-title" id="garage-form-title">
              Add Vehicle
            </h3>

            <div class="form-group">
              <label class="form-label" for="garageNickname"
                >Nickname (Optional)</label
              >
              <input
                type="text"
                id="garageNickname"
                class="form-input"
                placeholder="My Civic, Wife's SUV, etc."
              />
              <small class="form-hint"
                >A friendly name to help you identify this vehicle</small
              >
            </div>

            <div class="form-row">
              <div class="form-group">
                <label class="form-label" for="garageYear">Year *</label>
                <input
                  type="number"
                  id="garageYear"
                  class="form-input"
                  placeholder="2020"
                  min="1900"
                  max="2030"
                  required
                />
              </div>
              <div class="form-group">
                <label class="form-label" for="garageMake">Make *</label>
                <input
                  type="text"
                  id="garageMake"
                  class="form-input"
                  placeholder="Honda"
                  required
                />
              </div>
              <div class="form-group">
                <label class="form-label" for="garageModel">Model *</label>
                <input
                  type="text"
                  id="garageModel"
                  class="form-input"
                  placeholder="Civic"
                  required
                />
              </div>
            </div>

            <div class="form-row">
              <div class="form-group">
                <label class="form-label" for="garageTrim">Trim</label>
                <input
                  type="text"
                  id="garageTrim"
                  class="form-input"
                  placeholder="EX-L"
                />
              </div>
              <div class="form-group">
                <label class="form-label" for="garageMileage">Mileage</label>
                <input
                  type="number"
                  id="garageMileage"
                  class="form-input"
                  placeholder="50000"
                  min="0"
                />
              </div>
            </div>

            <div class="form-group">
              <label class="form-label" for="garageVin">VIN</label>
              <input
                type="text"
                id="garageVin"
                class="form-input"
                placeholder="1HGBH41JXMN109186"
                maxlength="17"
              />
            </div>

            <div class="form-group">
              <label class="form-label" for="garageCondition">Condition</label>
              <select id="garageCondition" class="form-select">
                <option value="">Select Condition</option>
                <option value="excellent">Excellent</option>
                <option value="good">Good</option>
                <option value="fair">Fair</option>
                <option value="poor">Poor</option>
              </select>
            </div>

            <div class="form-row">
              <div class="form-group">
                <label class="form-label" for="garageEstimatedValue"
                  >Estimated Trade-In Value</label
                >
                <input
                  type="text"
                  id="garageEstimatedValue"
                  class="form-input currency-input"
                  placeholder="$15,000"
                />
                <small class="form-hint"
                  >Your estimate of what dealers might offer</small
                >
              </div>
              <div class="form-group">
                <label class="form-label" for="garagePayoffAmount"
                  >Payoff Amount</label
                >
                <input
                  type="text"
                  id="garagePayoffAmount"
                  class="form-input currency-input"
                  placeholder="$0"
                />
                <small class="form-hint">Outstanding loan balance</small>
              </div>
            </div>

            <div class="form-group">
              <label class="form-label" for="garageNotes">Notes</label>
              <textarea
                id="garageNotes"
                class="form-input"
                rows="3"
                placeholder="Any additional notes about this vehicle..."
              ></textarea>
            </div>

            <div class="garage-form-actions">
              <button
                type="button"
                class="btn btn-secondary"
                onclick="hideGarageForm()"
              >
                Cancel
              </button>
              <button
                type="button"
                class="btn btn-primary"
                onclick="saveGarageVehicle()"
              >
                <svg
                  width="16"
                  height="16"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M5 13l4 4L19 7"
                  ></path>
                </svg>
                Save Vehicle
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Edit Vehicle Modal -->
    <div id="edit-vehicle-modal" class="modal" style="display: none">
      <div class="modal-overlay" onclick="closeEditVehicleModal()"></div>
      <div class="modal-content edit-vehicle-modal">
        <button
          class="modal-close"
          onclick="closeEditVehicleModal()"
          aria-label="Close edit vehicle modal"
        >
          <svg
            width="24"
            height="24"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M6 18L18 6M6 6l12 12"
            ></path>
          </svg>
        </button>

        <div class="garage-header">
          <h3 class="modal-title">Edit Vehicle</h3>
          <p class="modal-description">
            Update your vehicle information
          </p>
        </div>

        <form id="edit-vehicle-form" class="edit-vehicle-form garage-body" onsubmit="event.preventDefault(); saveEditedVehicle();">
          <div class="form-group">
            <label class="form-label" for="editNickname">Nickname (Optional)</label>
            <input
              type="text"
              id="editNickname"
              class="form-input"
              placeholder="My Civic, Wife's SUV, etc."
            />
          </div>

          <div class="form-row">
            <div class="form-group">
              <label class="form-label" for="editYear">Year *</label>
              <input
                type="number"
                id="editYear"
                class="form-input"
                placeholder="2020"
                min="1900"
                max="2030"
                required
              />
            </div>
            <div class="form-group">
              <label class="form-label" for="editMake">Make *</label>
              <input
                type="text"
                id="editMake"
                class="form-input"
                placeholder="Honda"
                required
              />
            </div>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label class="form-label" for="editModel">Model *</label>
              <input
                type="text"
                id="editModel"
                class="form-input"
                placeholder="Civic"
                required
              />
            </div>
            <div class="form-group">
              <label class="form-label" for="editTrim">Trim</label>
              <input
                type="text"
                id="editTrim"
                class="form-input"
                placeholder="EX-L"
              />
            </div>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label class="form-label" for="editMileage">Mileage</label>
              <input
                type="number"
                id="editMileage"
                class="form-input"
                placeholder="50000"
                min="0"
              />
            </div>
            <div class="form-group">
              <label class="form-label" for="editCondition">Condition</label>
              <select id="editCondition" class="form-select">
                <option value="">Select condition</option>
                <option value="excellent">Excellent</option>
                <option value="good">Good</option>
                <option value="fair">Fair</option>
                <option value="poor">Poor</option>
              </select>
            </div>
          </div>

          <div class="form-group">
            <label class="form-label" for="editVin">VIN</label>
            <input
              type="text"
              id="editVin"
              class="form-input"
              placeholder="1HGBH41JXMN109186"
              maxlength="17"
            />
          </div>

          <div class="form-row">
            <div class="form-group">
              <label class="form-label" for="editEstimatedValue">Estimated Value</label>
              <input
                type="text"
                id="editEstimatedValue"
                class="form-input"
                placeholder="$15,000"
              />
            </div>
            <div class="form-group">
              <label class="form-label" for="editPayoffAmount">Payoff Amount</label>
              <input
                type="text"
                id="editPayoffAmount"
                class="form-input"
                placeholder="$0"
              />
            </div>
          </div>

          <div class="form-group">
            <label class="form-label" for="editNotes">Notes</label>
            <textarea
              id="editNotes"
              class="form-input"
              rows="3"
              placeholder="Additional notes about this vehicle..."
            ></textarea>
          </div>

          <div class="button-group">
            <button
              type="button"
              class="btn btn-secondary"
              onclick="closeEditVehicleModal()"
            >
              Cancel
            </button>
            <button type="submit" class="btn btn-primary">Save Changes</button>
          </div>
        </form>
      </div>
    </div>

    <!-- Submit Offer Modal -->
    <div id="submit-offer-modal" class="modal" style="display: none">
      <div class="modal-overlay" onclick="closeSubmitOfferModal()"></div>
      <div class="modal-content submit-offer-modal">
        <button
          class="modal-close"
          onclick="closeSubmitOfferModal()"
          aria-label="Close"
        >
          <svg
            width="24"
            height="24"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M6 18L18 6M6 6l12 12"
            ></path>
          </svg>
        </button>

        <div class="submit-offer-header">
          <div class="submit-offer-icon">
            <svg
              width="48"
              height="48"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8"
              />
            </svg>
          </div>
          <h2 class="submit-offer-title">Submit Your Offer</h2>
          <p class="submit-offer-subtitle">
            Share this offer with the dealer via multiple channels
          </p>
        </div>

        <div class="submit-offer-body">
          <!-- Offer Preview -->
          <div class="offer-preview-section">
            <h3 class="section-title">Offer Preview</h3>
            <div class="offer-preview-box">
              <pre id="offerPreviewText" class="offer-preview-text">
Loading offer...</pre
              >
            </div>
          </div>

          <!-- Customer Information -->
          <div class="profile-section">
            <h3 class="profile-section-title">Your Information</h3>
            <div class="form-group">
              <label class="form-label" for="submitCustomerName"
                >Full Name *</label
              >
              <input
                type="text"
                id="submitCustomerName"
                class="form-input"
                placeholder="John Smith"
                required
              />
            </div>
            <div class="form-row-2col">
              <div class="form-group">
                <label class="form-label" for="submitCustomerEmail"
                  >Email *</label
                >
                <input
                  type="email"
                  id="submitCustomerEmail"
                  class="form-input"
                  placeholder="john@email.com"
                  required
                />
              </div>
              <div class="form-group">
                <label class="form-label" for="submitCustomerPhone"
                  >Phone *</label
                >
                <input
                  type="tel"
                  id="submitCustomerPhone"
                  class="form-input"
                  placeholder="(555) 123-4567"
                  required
                />
              </div>
            </div>
          </div>

          <!-- Salesperson/Dealer Information -->
          <div class="profile-section">
            <h3 class="profile-section-title">Dealer Contact</h3>
            <div class="form-group">
              <label class="form-label" for="submitSalespersonName"
                >Salesperson Name</label
              >
              <input
                type="text"
                id="submitSalespersonName"
                class="form-input"
                placeholder="Mike Johnson"
                list="salespersonSuggestions"
              />
              <datalist id="salespersonSuggestions"></datalist>
            </div>
            <div class="form-group">
              <label class="form-label" for="submitDealershipName"
                >Dealership Name</label
              >
              <input
                type="text"
                id="submitDealershipName"
                class="form-input"
                placeholder="ABC Motors"
              />
            </div>
            <div class="form-row-2col">
              <div class="form-group">
                <label class="form-label" for="submitSalespersonPhone"
                  >Phone</label
                >
                <input
                  type="tel"
                  id="submitSalespersonPhone"
                  class="form-input"
                  placeholder="(555) 987-6543"
                />
              </div>
              <div class="form-group">
                <label class="form-label" for="submitSalespersonEmail"
                  >Email</label
                >
                <input
                  type="email"
                  id="submitSalespersonEmail"
                  class="form-input"
                  placeholder="dealer@example.com"
                />
              </div>
            </div>
            <small class="form-hint"
              >At least one contact method (phone or email) is required</small
            >
          </div>

          <!-- Additional Notes -->
          <div class="profile-section">
            <h3 class="profile-section-title">Additional Notes (Optional)</h3>
            <div class="form-group">
              <textarea
                id="submitOfferNotes"
                class="form-textarea"
                rows="3"
                placeholder="Add any specific requests or questions..."
              ></textarea>
            </div>
          </div>
        </div>

        <div class="submit-offer-footer">
          <div class="submission-buttons">
            <button
              type="button"
              class="btn-share"
              onclick="handleShareOffer()"
              id="btnShareOffer"
            >
              <svg
                width="18"
                height="18"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z"
                />
              </svg>
              Share
            </button>
            <button
              type="button"
              class="btn-email"
              onclick="handleEmailOffer()"
              id="btnEmailOffer"
            >
              <svg
                width="18"
                height="18"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"
                />
              </svg>
              Email
            </button>
            <button
              type="button"
              class="btn-sms"
              onclick="handleSmsOffer()"
              id="btnSmsOffer"
            >
              <svg
                width="18"
                height="18"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"
                />
              </svg>
              SMS
            </button>
            <button
              type="button"
              class="btn-copy"
              onclick="handleCopyOffer()"
              id="btnCopyOffer"
            >
              <svg
                width="18"
                height="18"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"
                />
              </svg>
              Copy
            </button>
          </div>
        </div>
      </div>
    </div>

    <div id="review-contract-modal" class="modal" style="display: none">
      <div class="modal-overlay" onclick="closeReviewContractModal()"></div>
      <div class="modal-content review-contract-modal">
        <button
          class="modal-close"
          onclick="closeReviewContractModal()"
          aria-label="Close"
        >
          <svg
            width="24"
            height="24"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M6 18L18 6M6 6l12 12"
            ></path>
          </svg>
        </button>

        <div class="contract-document" id="contract-document">
          <!-- Contract Header -->
          <div class="contract-header">
            <h1 class="contract-title">RETAIL BUYERS SUMMARY</h1>
            <p class="contract-subtitle">Payment & Financing Overview</p>
          </div>

          <!-- Truth in Lending Disclosure Box -->
          <div class="contract-til-box">
            <h2 class="contract-til-title">
              FEDERAL TRUTH IN LENDING DISCLOSURES
            </h2>
            <div class="contract-til-grid">
              <div class="contract-til-item">
                <div class="contract-til-label">Annual Percentage Rate</div>
                <div class="contract-til-desc">
                  The cost of your credit as a yearly rate
                </div>
                <div class="contract-til-value" id="contractAPR">--</div>
              </div>
              <div class="contract-til-item">
                <div class="contract-til-label">Finance Charge</div>
                <div class="contract-til-desc">
                  The dollar amount the credit will cost you
                </div>
                <div class="contract-til-value" id="contractFinanceCharge">
                  --
                </div>
              </div>
              <div class="contract-til-item">
                <div class="contract-til-label">Amount Financed</div>
                <div class="contract-til-desc">
                  The amount of credit provided to you
                </div>
                <div class="contract-til-value" id="contractAmountFinanced">
                  --
                </div>
              </div>
              <div class="contract-til-item">
                <div class="contract-til-label">Total of Payments</div>
                <div class="contract-til-desc">
                  The amount you will have paid after all payments
                </div>
                <div class="contract-til-value" id="contractTotalPayments">
                  --
                </div>
              </div>
            </div>
          </div>

          <!-- Payment Schedule -->
          <div class="contract-section">
            <h3 class="contract-section-title">Payment Schedule</h3>
            <div class="contract-payment-grid">
              <div class="contract-row">
                <span class="contract-label">Number of Payments:</span>
                <span class="contract-value" id="contractNumPayments">--</span>
              </div>
              <div class="contract-row">
                <span class="contract-label">Amount of Each Payment:</span>
                <span class="contract-value" id="contractMonthlyPayment"
                  >--</span
                >
              </div>
              <div class="contract-row">
                <span class="contract-label">When Payments Are Due:</span>
                <span class="contract-value"
                  >Monthly beginning 1 month from date hereof</span
                >
              </div>
            </div>
          </div>

          <!-- Vehicle Information -->
          <div class="contract-section">
            <h3 class="contract-section-title">Description of Motor Vehicle</h3>
            <div class="contract-vehicle-grid">
              <div class="contract-row">
                <span class="contract-label">Year Make Model:</span>
                <span class="contract-value" id="contractVehicle">--</span>
              </div>
              <div class="contract-row">
                <span class="contract-label"
                  >Vehicle Identification Number:</span
                >
                <span class="contract-value contract-vin" id="contractVIN"
                  >--</span
                >
              </div>
              <div class="contract-row">
                <span class="contract-label">Odometer Reading:</span>
                <span class="contract-value" id="contractMileage">--</span>
              </div>
              <div class="contract-row">
                <span class="contract-label">Condition:</span>
                <span class="contract-value" id="contractCondition">--</span>
              </div>
            </div>
          </div>

          <!-- Itemization of Costs -->
          <div class="contract-section">
            <h3 class="contract-section-title">Itemization of Costs</h3>
            <table class="contract-table">
              <tr class="contract-header">
                <td class="contract-item-label">Sale Price</td>
                <td class="contract-item-value" id="contractSalePrice">--</td>
              </tr>
              <tr class="contract-header">
                <td class="contract-item-label">LESS Cash Down</td>
                <td class="contract-item-value" id="contractDownPayment">--</td>
              </tr>
              <tr class="contract-header">
                <td class="contract-item-label">LESS Net Trade-In</td>
                <td class="contract-item-value" id="contractNetTrade">--</td>
              </tr>
              <tr>
                <td class="contract-item-label contract-indent">
                  Trade-In Allowance
                </td>
                <td class="contract-item-value" id="contractTradeAllowance">
                  --
                </td>
              </tr>
              <tr>
                <td class="contract-item-label contract-indent">
                  Trade-In Payoff
                </td>
                <td class="contract-item-value" id="contractTradePayoff">--</td>
              </tr>
              <tr class="contract-header">
                <td class="contract-item-label">Unpaid Balance</td>
                <td class="contract-item-value" id="contractUnpaidBalance">
                  --
                </td>
              </tr>
              <tr class="contract-header">
                <td class="contract-item-label">PLUS Other Charges</td>
                <td class="contract-item-value" id="contractOtherCharges">
                  --
                </td>
              </tr>
              <tr>
                <td class="contract-item-label contract-indent">
                  Total Dealer Fees
                </td>
                <td class="contract-item-value" id="contractDealerFees">--</td>
              </tr>
              <tr>
                <td class="contract-item-label contract-indent">
                  Total Customer Add-ons
                </td>
                <td class="contract-item-value" id="contractCustomerAddons">
                  --
                </td>
              </tr>
              <tr>
                <td class="contract-item-label contract-indent">
                  Total Gov't Fees
                </td>
                <td class="contract-item-value" id="contractGovtFees">--</td>
              </tr>
              <tr class="contract-header">
                <td class="contract-item-label">Sales Tax</td>
                <td class="contract-item-value" id="contractSaleTaxTotal">
                  --
                </td>
              </tr>
              <tr>
                <td
                  class="contract-item-label contract-indent"
                  id="contractStateTaxLabel"
                >
                  State Tax
                </td>
                <td class="contract-item-value" id="contractStateTax">--</td>
              </tr>
              <tr>
                <td
                  class="contract-item-label contract-indent"
                  id="contractCountyTaxLabel"
                >
                  County Tax
                </td>
                <td class="contract-item-value" id="contractCountyTax">--</td>
              </tr>
              <tr class="contract-subtotal">
                <td class="contract-item-label">Cash Due at Signing</td>
                <td class="contract-item-value" id="contractCashDue">--</td>
              </tr>
              <tr class="contract-total">
                <td class="contract-item-label">AMOUNT FINANCED</td>
                <td
                  class="contract-item-value"
                  id="contractAmountFinancedTotal"
                >
                  --
                </td>
              </tr>
            </table>
          </div>

          <!-- Disclosure Footer -->
          <div class="contract-footer">
            <p>
              <strong>IMPORTANT:</strong> This summary is provided for your
              convenience to help you understand the key terms of your potential
              purchase. All final terms and conditions will be presented at the
              dealership.
            </p>
          </div>
        </div>

        <!-- Action Buttons -->
        <div class="contract-actions">
          <button
            type="button"
            class="btn btn-secondary"
            onclick="closeReviewContractModal()"
          >
            Close
          </button>
          <button
            type="button"
            class="btn btn-success"
            onclick="openSubmitOfferModal()"
            id="btnSubmitOfferFromContract"
          >
            <svg
              width="20"
              height="20"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8"
              />
            </svg>
            Submit Offer
          </button>
          <button
            type="button"
            class="btn btn-primary"
            onclick="printContract()"
          >
            <svg
              width="20"
              height="20"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <polyline points="6 9 6 2 18 2 18 9"></polyline>
              <path
                d="M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"
              ></path>
              <rect x="6" y="14" width="12" height="8"></rect>
            </svg>
            Print Contract
          </button>
        </div>
      </div>
    </div>

    <!-- Floating Payment Tooltip -->
    <div
      id="slider-payment-tooltip"
      class="slider-payment-tooltip"
      style="display: none"
    >
      <div class="tooltip-payment">$0/mo</div>
      <div class="tooltip-change">--</div>
    </div>

    <!-- JavaScript -->
    <script type="module" src="app.js"></script>
  </body>
</html>
