<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="stylesheet" href="styles.css" />

    <!-- Title -->
    <title>Brandon's Calculator</title>

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:ital,wght@0,100;0,200;0,300;0,400;1,100;1,200;1,300&family=Montserrat:ital,wght@0,100..900;1,100..900&family=Oswald:wght@200..700&family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&family=Roboto+Condensed:ital,wght@0,100..900;1,100..900&family=Roboto:ital,wght@0,100..900;1,100..900&family=Saira+Extra+Condensed:wght@100;200;300;400;500;600;700;800;900&display=swap" rel="stylesheet">    
    <!-- Favicon & App Icons -->
    <link rel="icon" href="/icons/favicon.ico" sizes="any">
    <link rel="icon" type="image/png" sizes="32x32" href="/icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/icons/favicon-16x16.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="192x192" href="/icons/android-chrome-192x192.png">
    <link rel="icon" type="image/png" sizes="512x512" href="/icons/android-chrome-512x512.png">
    
    <!-- PWA Manifest-->
    <link rel="manifest" href="site.webmanifest">
    <meta name="theme-color" content="#0b1f2a">
    <!-- Supabase credentials (fill these values) -->
    <meta name="supabase-url" content="">
    <meta name="supabase-anon-key" content="">
    <script type="module" src="app.js"></script>
  </head>
    <body>
      <!-- Floating Payment Sidebar -->
      <div class="floatingPmtNote" id="floatingPaymentCard" aria-live="polite">
        <div class="floatingPmtNote__meta">
          <span class="floatingPmtNote__metaLabel">PMT</span>
          <span
            class="floatingPmtNote__metaValue usdFormat"
            type="text"
            id="floatingMonthlyPmt"
            data-role="monthly-payment"
            aria-label="Monthly payment"
          >$0.00</span>
          <span class="floatingPmtNote__metaLabel">APR</span>
          <span class="floatingPmtNote__metaValue" id="floatingAprValue">5.99%</span>
          <span class="floatingPmtNote__metaLabel">TERM</span>
          <span class="floatingPmtNote__metaValue" id="floatingTermValue">72</span>
        </div>
      </div>
      <!-- All Cards -->
      <main>
        <!-- Card Wrapper -->
        <div class="flexCards">
          <!-- Saved Vehicle Card -->
          <div class="card cornerAnchor" id="SavedVehicleCard">
            <!-- Logo -->
            <img
              class="cornerBadge cornerBadge--top-left"
              src="./assets/brandons_calculator_patch_1_120px.png"
              alt="Brandon's Calculator logo"
            />            
            <!-- Saved Vehicles -->
            <div>
              <h2 class="flexSpace">Saved Vehicles</h2>
            </div>
            <div>
              <form class="flexCenter" id="vehicleForm">
                <select class="cell vehicleDropDown" id="vehicleSelect">
                  <option value="">--Select a Saved Vehicle--</option>
                </select>
                  <div class="vehicleButtons">
                    <button type="button" data-vehicle-action="add">ADD</button>
                    <button type="button" data-vehicle-action="update">UPDATE</button>
                    <button type="button" data-vehicle-action="delete">DELETE</button>
                  </div>
                  <div class="authLinks">
                    <span class="authLinks__text">
                      Need an account?
                      <a
                        type="button"
                        class="linkButton"
                        data-auth-link="signin">
                        Sign in
                      </a>
                    </span>
                  </div>
              </form>
            </div>
          </div>
          <!-- Location Card -->
          <div class="card" id="locationCard">
            <h2 class="flexSpace">Home Address</h2>
              <div class="flexCenter">
                <input
                  type="text"
                  id="locationSearch"
                  placeholder="Enter Location">
                </input>
              </div>
              <div class="grid2" id="localeNote">
                <p id="reqAddressNote" class="row2" >Required to Compute Gov't Fees and Sales Tax</p>
              </div>
          <!-- Dealer Directions Card -->
          <div class="mapCanvas" id="dealerMapCard">
            <div
              id="dealerMap"
              class="mapCanvas"
              role="application"
              aria-label="Driving directions to selected dealer"
            ></div>
            <p
              id="dealerMapStatus"
              class="dealerMapStatus"
              role="status"
              aria-live="polite"
            >
              Enter your home address and select a Saved Vehicle to preview directions.
            </p>
          </div>
          </div>
          <!-- Sale Summary Card -->
          <div class="card" id="saleSummaryCard">
            <div class="flexSpace">
              <h2>Sale Summary</h2>
            </div>
            <!-- Savings Note-->
            <form class="grid2">
              <output
                id="savingsNote"
                class="note col2">
              </output>
            
              <!-- Sale Price -->
              <label class="col1" for="salePrice">SALE PRICE</label>
                <input
                  class="cell output stdWidth col2 usdFormat"
                  type="text"
                  id="salePrice"
                  placeholder="$0.00">
                </input>

              <!-- Trade Offer -->
              <label class="col1" for="tradeOffer">TRADE OFFER</label>
                <input
                  class="cell output stdWidth col2 usdFormat"
                  type="text"
                  id="tradeOffer"
                  placeholder="$0.00">
                </input>

              <!-- Trade Payoff -->
              <label class="col1" for="tradePayoff">TRADE PAYOFF</label>
                <input
                  class="cell output stdWidth col2 usdFormat"
                  type="text"
                  id="tradePayoff"
                  placeholder="$0.00">
                </input>

              <!-- Equity -->
              <label class="col1" for="equity">EQUITY</label>
                <output
                  class="output col2 stdWidth mutedOutput"
                  id="equity"
                  placeholder="$0.00">
                </output>
              <!-- Cash Difference -->
              <label
                class="col1 labelWithTooltip"
                for="tradeDifference"
                data-tooltip="Sale Price - Trade Offer"
                tabindex="0"
              >TRADE DIFFERENCE</label>
                <output
                  class="output col2 stdWidth mutedOutput"
                  id="tradeDifference"
                  placeholder="$0.00">
                </output>
              <!-- Net Trade Difference -->
              <label
                class="col1 labelWithTooltip"
                for="netTrade"
                data-tooltip="Sale Price - Equity"
                tabindex="0"
              >NET TRADE DIFFERENCE</label>
                <output
                  class="output col2 stdWidth mutedOutput"
                  id="netTrade"
                  placeholder="$0.00">
                </output>
            </form>
          </div>
          <!-- Fees Card-->
          <div class="card" id="feesCard">
            <div class="flexSpace">
              <h2>Dealer & Gov't Fees</h2>
            </div>
            <div class="flexEnd vehicleButtons">
              <button id="editFeeButton" type="button">EDIT</button>
            </div>
              <!-- Fee Headers -->
            <form class="grid5">
              <header
                class="col1 feeHeaders">TYPE
              </header>
              <header
                class="col2 feeHeaders">DESCRIPTION
              </header>
              <header
                class="col3 feeHeaders">AMOUNT
              </header>

              <!-- Dealer Fees -->
              <label class="col1 feeLabels" for="dealerFeeDesc">DEALER</label>
                <input
                  id="dealerFeeDesc"
                  class="cellFeeDesc col2"
                  type="text"
                  placeholder="e.g. Doc Fee">
                </input>
                <input
                  id="dealerFeeAmount"
                  class="cellFeeAmount col3 usdFormat"
                  type="text"
                  placeholder="$0.00">
                </input>
                <button class="xButtons" type="button" aria-label="Add another dealer fee">-</button>
                <button class="xButtons" type="button" aria-label="Add another dealer fee">+</button>
                
                <!-- Dealer Fees Total -->
                <label class="col2 mutedFeeLabels" for="totalDealerFees">TOTAL DEALER FEES</label>
                  <output
                    class="mutedFeeOutput col3"
                    type="text"
                    id="totalDealerFees"
                    placeholder="$0.00">
                  </output>

              <!-- Customer Add-ons -->
              <label class="col1 feeLabels" for="customerAddonDesc">CUSTOMER</label>
                <input
                  id="customerAddonDesc"
                  class="cellFeeDesc col2"
                  type="text"
                  placeholder="e.g. Extended Warranty">
                </input>
                <input
                  id="customerAddonAmount"
                  class="cellFeeAmount col3 usdFormat"
                  type="text"
                  placeholder="$0.00">
                </input>
                <button class="xButtons" type="button" aria-label="Add another customer add-on">-</button>
                <button class="xButtons" type="button" aria-label="Add another customer add-on">+</button>

                <!-- Customer Add-ons Total -->
                <label class="col2 mutedFeeLabels" for="totalCustomerAddons">TOTAL CUSTOMER ADD-ONS</label>
                  <output
                    class="mutedFeeOutput col3"
                    type="text"
                    id="totalCustomerAddons"
                    placeholder="$0.00">
                  </output>

              <!-- Gov't Fees -->
              <label class="col1 feeLabels" for="govtFeeDesc">GOV'T</label>
                <input
                  id="govtFeeDesc" 
                  class="cellFeeDesc col2"
                  type="text"
                  placeholder="e.g. Electronic Title">
                </input>
                <input
                  id="govtFeeAmount"
                  class="cellFeeAmount col3 usdFormat"
                  type="text"
                  placeholder="$0.00">
                </input>
                <button class="xButtons" type="button" aria-label="Add another dealer fee">-</button>
                <button class="xButtons" type="button" aria-label="Add another dealer fee">+</button>

              <!-- Gov't Fees Total -->
                <label class="col2 mutedFeeLabels" for="totalGovtFees">TOTAL GOV'T FEES</label>
                  <output
                    class="mutedFeeOutput col3"
                    type="text"
                    id="totalGovtFees"
                    placeholder="$0.00">
                  </output>
            </form>

                <!-- Total Fees -->
              <div class="flexEnd">
                <label class="output bigOutput" for="totalTF">TOTAL FEES</label>
                  <output
                    class="output bigOutput usdFormat"
                    type="text"
                    id="totalTF"
                    placeholder="$0.00">
                  </output>
              </div>
          </div>
          <!-- Taxes Card-->
          <div class="card" id="taxesCard">
            <h2 class="flexSpace">Taxes</h2>
            <div class="note" id="taxNote"></div>
            <form class="grid3 flexEnd">
              <!-- Taxable Base -->
              <label
                class="col1 labelWithTooltip"
                for="taxableBase"
                data-tooltip="Trade Difference + Dealer Fees + Customer Add-ons"
                tabindex="0"
              >TAXABLE BASE</label>
              <output
                class="col3 output mutedOutput"
                id="taxableBase"
                placeholder="$0.00">
              </output>
              <!-- State Tax -->
              <label
                class="col1 labelWithTooltip"
                for="stateTax"
                data-tooltip="Taxable Base × State Tax Rate"
                tabindex="0"
              >STATE TAXES</label>
              <input
                class="cell output shortWidth col2 percentFormat"
                type="text"
                id="stateTax"
                placeholder="6.0%">
              </input>
              <output
                class="output mutedOutput col3"
                id="stateTaxTotal"
                placeholder="$0.00">$0.00
              </output>
              <!-- County Tax -->
              <label
                class="col1 labelWithTooltip"
                for="countyTax"
                data-tooltip="County Tax Base (Max $5k) × County Tax Rate"
                tabindex="0"
              >COUNTY TAXES</label>
              <input
                  class="cell output shortWidth col2 percentFormat"
                  type="text"
                  id="countyTax"
                  placeholder="1.0%">
              </input>
              <output
                  class="output mutedOutput col3"
                  id="countyTaxTotal"
                  placeholder="$0.00">$0.00
              </output>
            </form>
            <!-- Total Taxes -->
            <div class="flexEnd">
              <label
                class="output bigOutput labelWithTooltip"
                for="totalTaxes"
                data-tooltip="State Taxes + County Taxes"
                tabindex="0"
              >TOTAL TAXES</label>
              <output
                class=" output bigOutput usdFormat"
                type="text"
                id="totalTaxes"
                placeholder="$0.00">
              </output>
            </div>
          </div>
          <!-- Cash Balance Card-->
          <div class="card" id="cashBalanceCard">
            <h2 class="flexSpace">Cash Balance</h2>
            <div class="insideCard grid2" id="checkboxGrid">
              <label class="feeLabels col2 row1" for="financeTF">Finance Taxes & Fees?
                <input
                  type="checkbox"
                  id="financeTF"
                  checked>
              </label>
              <output
                id="financeTFNote"
                class="feeLabels col1 row1"
              ></output>
              <label class="feeLabels col2 row2" for="financeNegEquity">Finance Neg Equity?
                <input
                  type="checkbox"
                  id="financeNegEquity"
                  checked>
              </label>
              <output
                id="financeNegEquityNote"
                class="feeLabels col1 row2"
              ></output>
              <label class="feeLabels col2 row3" for="cashOutEquity">Cash Out Equity?
                <input
                  type="checkbox"
                  id="cashOutEquity">
              </label>
              <output
                id="cashOutEquityNote"
                class="feeLabels col1 row3"
              ></output>
            </div>
            <!-- Cash Down -->
            <form class="grid2">
              <label class="col1" for="cashDown">CASH DOWN</label>
                <input
                  class="cell output stdWidth col2 usdFormat"
                  type="text"
                  id="cashDown"
                  placeholder="$0.00">
                </input>
              <!-- Cash 2 Buyer -->
              <label class="col1" for="cash2Buyer">CASH TO BUYER</label>
                <output
                  class="output col2 stdWidth usdFormat"
                  type="text"
                  id="cash2Buyer"
                  placeholder="$0.00">
                </output>
                <!-- Cash Due -->
                <label class="col1" for="cashDue">CASH DUE AT SIGNING</label>
                  <output
                    class="output col2 stdWidth usdFormat"
                    type="text"
                    id="cashDue"
                    placeholder="$0.00">
                  </output>
            </form>
              <!-- Amount Financed -->
            <div class="flexEnd">
              <label
                class="output bigOutput"
                for="amountFinanced">TOTAL FINANCED
              </label>
                <output
                  id="amountFinanced"
                  class=" output bigOutput usdFormat"
                  type="text"
                  placeholder="$0.00">
                </output>
            </div>
            <!-- Contract Summary Button -->
            <div class="flexEnd">
              <button
                id="viewContractButton"
                type="button"
                title="View contract summary in RouteOne format">
                VIEW CONTRACT SUMMARY
              </button>
            </div>
          </div>
          <!-- Financing Card -->
          <div class="card" id="financingCard">
            <h2 class="flexSpace">Financing</h2>
            <span class="flexEnd" aria-hidden="true"></span>
              <output
                class="note"
                id="rateSourceName"
                aria-live="polite">
                User Defined APR
              </output>
            <form class="grid2">
              <label class="col1" for="rateSource">APR SOURCE</label>
                <select class="cell output stdWidth col2" id="rateSource">
                  <option value="userDefined">User Defined</option>
                  <option value="lowest">Lowest Price by APR</option>
                </select>
              <label class="col1" for="creditScore">CREDIT SCORE</label>
                <input
                  class="cell output col2 stdWidth"
                  type="number"
                  id="creditScore"
                  min="300"
                  max="850"
                  value="750"
                  placeholder="750">
                </input>
              <label class="col1" for="vehicleCondition">VEHICLE CONDITION</label>
                <select class="cell output col2 stdWidth" id="vehicleCondition">
                  <option value="new" selected>New</option>
                  <option value="used">Used</option>
                </select>
              <label class="col1" for="financeApr">APR</label>
                <input
                  class="cell output col2 stdWidth percentFormat"
                  type="text"
                  id="financeApr"
                  value="5.99%"
                  placeholder="5.99%">
                </input>
              <label class="col1" for="financeTerm">TERM (months)</label>
                <select class="cell output col2 stdWidth" id="financeTerm">
                  <option value="24">24</option>
                  <option value="36">36</option>
                  <option value="48">48</option>
                  <option value="60">60</option>
                  <option value="72" selected>72</option>
                  <option value="84">84</option>
                  <option value="96">96</option>
                </select>
            </form>
              <div class="flexEnd">
                <label class="output bigOutput" for="monthlyPmt">MONTHLY PAYMENT</label>
                  <output
                    class="output bigOutput usdFormat"
                    type="text"
                    id="monthlyPmt"
                    data-role="monthly-payment"
                    placeholder="$0.00">
                  </output>
                  <output class="note" id="rateSourceStatus"></output>
              </div>
          </div>
          <!-- Affordability -->
          <div class="card" id="affordabilityCard">
            <h2 class="flexSpace">Affordability</h2>
            <form class="grid2">
              <label class="col1" for="affordability">MAX MONTHLY PMT</label>
                <input
                  class="cell output stdWidth col2 usdFormat"
                  type="text"
                  id="affordability"
                  value="1000"
                  placeholder="$0.00">
                </input>
              <label class="col1" for="affordApr">APR</label>
                <output
                  class="output stdWidth col2 percentFormat"
                  id="affordApr"
                  aria-live="polite">
                </output>
              <label class="col1" for="affordTerm">TERM (months)</label>
                <output
                  class="output stdWidth col2 percentFormat"
                  id="affordTerm"
                  aria-live="polite">
                </output>
            </form>
            <div class="flexEnd">
              <label class="bigOutput" for="maxTotalFinanced">MAX TOTAL FINANCED</label>
                <output
                  class="output stdWidth bigOutput usdFormat"
                  type="text"
                  id="maxTotalFinanced"
                  placeholder="$0.00">
                </output>
            </div>
            <div class="flexEnd">
              <output class="output short note" id="affordabilityGap"></output>
            </div>
          </div>
        </div>
        <!-- Card Wrapper-->


        <!-- Modals -->
        <div
          id="editFeeModal"
          class="modalOverlay"
          aria-hidden="true"
          role="dialog"
          aria-modal="true"
          aria-labelledby="editFeeModalTitle"
        >
          <div class="card modalCard">
            <header class="modalHeader">
              <h3 id="editFeeModalTitle">Edit Fee</h3>
              <button
                type="button"
                class="modalClose"
                aria-label="Close edit fee dialog"
                data-editfee-action="close"
              >
                ×
              </button>
            </header>
            <form id="editFeeForm" class="modalCard">
              <label for="editFeeType">Fee Type
                <select id="editFeeType" class="cell" name="type">
                  <option value="dealer">Dealer</option>
                  <option value="gov">Gov't</option>
                </select>
              </label>
              <label for="editFeeName">Description
                <input
                  id="editFeeName"
                  class="cell"
                  type="text"
                  name="description"
                  placeholder="e.g. Doc Fee"
                  required
                />
              </label>
              <label for="editFeeAmount">Amount
                <input
                  id="editFeeAmount"
                  class="cell usdFormat"
                  type="text"
                  name="amount"
                  placeholder="$0.00"
                  required
                />
              </label>
              <footer class="modalActions">
                <button type="submit" class="modalPrimary">Save</button>
                <button type="button" class="modalSecondary" data-editfee-action="cancel">
                  Cancel
                </button>
              </footer>
              <p class="modalStatus colMerged" id="editFeeStatus" role="status" aria-live="polite"></p>
            </form>
          </div>
        </div>
        <!-- Vehicle Modal -->
        <div
            id="vehicleModal"
            class="modalOverlay"
            aria-hidden="true"
            role="dialog"
            aria-modal="true"
            aria-labelledby="vehicleModalTitle">
            <div class="card modalCard">
              <header class="modalHeader">
                <h3 id="vehicleModalTitle">Save Vehicle</h3>
                <button
                  type="button"
                  class="modalClose"
                  aria-label="Close vehicle editor"
                  data-modal-action="close"
                >
                  ×
                </button>
              </header>
              <form id="vehicleModalForm" class="modalCard">
                <div class="insideCard flexCenter">
                  <label for="modalVin" class="flexCenter modalVin">VEHICLE IDENTIFICATION NUMBER (VIN)
                    <input
                      id="modalVin"
                      class="modalVinInput flexCenter"
                      type="text"
                      name="vin"
                      maxlength="17"
                      inputmode="text"
                      autocomplete="off"
                      placeholder="Insert a VIN">
                    </input>
                  </label>
                  <span class="note flexCenter" id="vinNote">Enter a VIN to Auto-Populate the Remaining Fields</span>
                </div>
                  <label for="modalVehicleName">Vehicle
                  <input
                    id="modalVehicleName"
                    class="softInput"
                    type="text"
                    name="vehicle"
                    autocomplete="off"
                  />
                </label>
                <label for="modalCondition">Condition
                  <select
                    id="modalCondition"
                    class="softInput"
                    name="condition"
                  >
                    <option value="">--Select Condition--</option>
                    <option value="New">New</option>
                    <option value="Used">Used</option>
                    <option value="Certified">Certified Pre-Owned</option>
                  </select>
                </label>
                <label for="modalYear">Year
                  <input
                    id="modalYear"
                    class="softInput"
                    type="text"
                  />
                </label>
                <label for="modalMake">Make
                  <input
                    id="modalMake"
                    class="softInput"
                    type="text"
                    name="make"
                    autocomplete="off"
                  />
                </label>
                <label for="modalModel">Model
                  <input
                    id="modalModel"
                    class="softInput"
                    type="text"
                    name="model"
                    autocomplete="off"
                  />
                </label>
                <label for="modalTrim">Trim
                  <input
                    id="modalTrim"
                    class="softInput"
                    type="text"
                    name="trim"
                    autocomplete="off"
                  />
                </label>
                </label>
                <label for="modalMileage">Mileage
                  <input
                    id="modalMileage"
                    class="softInput"
                    type="number"
                    name="mileage"
                    min="0"
                    step="1"
                    autocomplete="off"
                  />
                </label>
                <label for="modalAskingPrice">Asking Price
                  <input
                    id="modalAskingPrice"
                    class="softInput usdFormat"
                    type="text"
                    name="asking_price"
                    autocomplete="off"
                  />
                </label>
                <div class="flexEnd">
                  <label>Dealer
                    <input class="softInput" id="modalDealerName" name="dealer_name" />
                  </label>
                  <label>Street Address
                    <input class="softInput" id="modalDealerStreet" name="dealer_street" />
                  </label>
                  <label>City
                    <input class="softInput" id="modalDealerCity" name="dealer_city" />
                  </label>
                  <label>State
                    <input class="softInput" id="modalDealerState" name="dealer_state" />
                  </label>
                  <label>Zip Code
                    <input class="softInput" id="modalDealerZip" name="dealer_zip" />
                  </label>
                    <input type="hidden" id="modalDealerLat" name="dealer_lat" />
                    <input type="hidden" id="modalDealerLng" name="dealer_lng" />
                    <input type="hidden" id="modalDealerPhone" name="dealer_phone" />
                </div>
                <p class="modalNote">
                  Have an account?
                  <button type="button" class="linkButton" data-auth-link="signin">
                    Sign in
                  </button>
                  or
                  <button type="button" class="linkButton" data-auth-link="signup">
                    Create one
                  </button>
                  to save vehicles.
                </p>
                  <label class="flexSpace" for="modalDealerAddress">Dealer Search
                    <input
                      id="modalDealerAddress"
                      class="softInput"
                      type="text"
                      name="dealer_address"
                      placeholder="Search dealer or address"
                      autocomplete="off">
                    </input>
                  </label>
                <footer class="modalActions">
                  <button type="button" class="modalPrimary">Submit</button>
                  <button
                    type="button"
                    class="modalSecondary"
                    data-modal-action="cancel"
                  >
                    Cancel
                  </button>
                </footer>
                <p class="modalStatus" role="status" aria-live="polite"></p>
              </form>
          </div>
        </div>
        <!-- Authorization Modal -->
        <div
          id="authModal"
          class="modalOverlay"
          aria-hidden="true"
          role="dialog"
          aria-modal="true"
          aria-labelledby="authModalTitle"
        >
          <div class="card modalCard">
            <header class="modalHeader">
              <h3 id="authModalTitle">Sign In</h3>
              <button
                type="button"
                class="modalClose"
                aria-label="Close sign-in dialog"
                data-auth-action="close"
              >
                ×
              </button>
            </header>
            <form id="authForm">
              <label class="flexEnd" for="authEmail">Email
                <input
                  id="authEmail"
                  class="softInput"
                  type="email"
                  name="email"
                  autocomplete="username"
                  required
                />
              </label>
              <label class="flexEnd" for="authPassword">Password
                <input
                  id="authPassword"
                  class="softInput"
                  type="password"
                  name="password"
                  autocomplete="current-password"
                  required
                />
              </label>
              <footer class="modalActions">
                <button type="submit" class="modalPrimary">Sign In</button>
                <button
                  type="button"
                  class="modalSecondary"
                  data-auth-action="cancel"
                >
                  Cancel
                </button>
              </footer>
              <p class="authToggle">
                <span data-auth-copy="prompt">Need an account?</span>
                <button
                  type="button"
                  class="linkButton"
                  data-auth-action="toggle-mode"
                >
                  Create one
                </button>
              </p>
              <p class="modalStatus" role="status" aria-live="polite"></p>
            </form>
          </div>
        </div>

        <!-- Contract Summary Modal -->
        <div
          id="contractModal"
          class="modalOverlay"
          aria-hidden="true"
          role="dialog"
          aria-modal="true"
          aria-labelledby="contractModalTitle"
        >
          <div class="card contractModalCard">
            <header class="modalHeader">
              <h3 id="contractModalTitle">Sale & Finance Summary</h3>
              <button
                type="button"
                class="modalClose"
                aria-label="Close contract summary"
                data-contract-action="close"
              >
                ×
              </button>
            </header>

            <div class="contractContent">
              <!-- Contract Header -->
              <div class="contractHeader">
                <h4 class="contractTitle">RETAIL CUSTOMER OFFER & FINANCIAL ESTIMATE</h4>
              </div>

              <!-- Customer Contact Information -->
              <section class="contractSection">
                <h5 class="contractSectionTitle">CUSTOMER INFO</h5>
                <div class="contractForm">
                  <div class="contractFormRow">
                    <div class="contractFormField">
                      <label for="contractCustomerFirstName" class="contractFormLabel">FIRST NAME</label>
                      <input type="text" id="contractCustomerFirstName" class="contractFormInput" placeholder="First Name">
                    </div>
                    <div class="contractFormField">
                      <label for="contractCustomerLastName" class="contractFormLabel">LAST NAME</label>
                      <input type="text" id="contractCustomerLastName" class="contractFormInput" placeholder="Last Name">
                    </div>
                  </div>
                  <div class="contractFormRow">
                    <div class="contractFormField">
                      <label for="contractCustomerPhone" class="contractFormLabel">PHONE</label>
                      <input type="tel" id="contractCustomerPhone" class="contractFormInput" placeholder="(555) 555-5555">
                    </div>
                    <div class="contractFormField">
                      <label for="contractCustomerEmail" class="contractFormLabel">EMAIL</label>
                      <input type="email" id="contractCustomerEmail" class="contractFormInput" placeholder="email@example.com">
                    </div>
                  </div>
                  <div class="contractFormRow">
                    <div class="contractFormField contractFormFieldFull">
                      <label for="contractCustomerAddress" class="contractFormLabel">HOME ADDRESS</label>
                      <input type="text" id="contractCustomerAddress" class="contractFormInput" placeholder="Street, City, State ZIP">
                    </div>
                  </div>
                </div>
              </section>

              <!-- Dealer Information -->
              <section class="contractSection">
                <h5 class="contractSectionTitle">DEALER INFORMATION</h5>
                <div id="contractDealerNote" class="contractNote" style="display: none;">
                  Note: Dealer details were not provided.
                </div>
                <div class="contractGrid" id="contractDealerGrid">
                  <div class="contractRow">
                    <span class="contractLabel">DEALER NAME</span>
                    <span class="contractValue" id="contractDealerName"></span>
                  </div>
                  <div class="contractRow">
                    <span class="contractLabel">STREET</span>
                    <span class="contractValue" id="contractDealerStreet"></span>
                  </div>
                  <div class="contractRow">
                    <span class="contractLabel">CITY</span>
                    <span class="contractValue" id="contractDealerCity"></span>
                  </div>
                  <div class="contractRow">
                    <span class="contractLabel">STATE</span>
                    <span class="contractValue" id="contractDealerState"></span>
                  </div>
                  <div class="contractRow">
                    <span class="contractLabel">ZIP</span>
                    <span class="contractValue" id="contractDealerZip"></span>
                  </div>
                  <div class="contractRow">
                    <span class="contractLabel">PHONE</span>
                    <span class="contractValue" id="contractDealerPhone"></span>
                  </div>
                </div>
              </section>

              <!-- Offer Hero Section -->
              <section class="contractSection offerHeroSection">
                <div id="contractVehicleNote" class="contractNote" style="display: none;">
                  Note: Vehicle details were not provided. This contract summary reflects loan calculations only.
                </div>
                <div class="offerHero">
                  <div class="offerLabel">CUSTOMER OFFER</div>
                  <div class="offerPrice" id="heroOfferPrice">$50,000.00</div>
                  <div class="offerVehicleDetails">
                    <span id="heroYear"></span>
                    <span id="heroMake"></span>
                    <span id="heroModel"></span>
                    <span id="heroTrim"></span>
                  </div>
                  <div class="offerVehicleMeta">
                    <span class="offerVin" id="heroVin"></span>
                  </div>
                </div>
              </section>

              <!-- Federal Truth-in-Lending Disclosures -->
              <section class="contractSection contractDisclosures">
                <div class="tilHeader">
                  <h5>ESTIMATED FEDERAL TRUTH-IN-LENDING DISCLOSURES</h5>
                  <p class="note">*** YOUR ACTUAL AMOUNTS MAY VARY BASED ON YOUR APPROVED CREDIT & LENDER AGREEMENT ***</p>
                </div>
                <div class="disclosuresGrid">
                  <div class="disclosureItem">
                    <div class="disclosureLabel">ANNUAL<br/>PERCENTAGE<br/>RATE</div>
                    <div class="disclosureValue" id="contractAPR">5.99%</div>
                    <div class="disclosureNote">The cost of your credit as a yearly rate</div>
                  </div>
                  <div class="disclosureItem">
                    <div class="disclosureLabel">FINANCE<br/>CHARGE</div>
                    <div class="disclosureValue" id="contractFinanceCharge">$8,500.00</div>
                    <div class="disclosureNote">The dollar amount the credit will cost you</div>
                  </div>
                  <div class="disclosureItem">
                    <div class="disclosureLabel">AMOUNT<br/>FINANCED</div>
                    <div class="disclosureValue" id="contractAmountFinanced">$45,000.00</div>
                    <div class="disclosureNote">The amount of credit provided to you</div>
                  </div>
                  <div class="disclosureItem">
                    <div class="disclosureLabel">TOTAL OF<br/>PAYMENTS</div>
                    <div class="disclosureValue" id="contractTotalPayments">$53,500.00</div>
                    <div class="disclosureNote">The amount you will have paid after making all payments as scheduled</div>
                  </div>
                  <div class="disclosureItem">
                    <div class="disclosureLabel">TOTAL<br/>SALE<br/>PRICE</div>
                    <div class="disclosureValue" id="contractTotalSalePrice">$55,990.00</div>
                    <div class="disclosureNote">The total cost of your purchase on credit</div>
                  </div>
                </div>
              </section>

              <!-- Payment Schedule -->
              <section class="contractSection">
                <h5 class="contractSectionTitle">PAYMENT SCHEDULE</h5>
                <div class="paymentSchedule">
                  <div class="paymentRow">
                    <span class="paymentLabel">NUMBER OF PAYMENTS</span>
                    <span class="paymentValue" id="contractNumPayments">72</span>
                  </div>
                  <div class="paymentRow">
                    <span class="paymentLabel">AMOUNT OF PAYMENTS</span>
                    <span class="paymentValue" id="contractPaymentAmount">$750.00</span>
                  </div>
                  <div class="paymentRow">
                    <span class="paymentLabel">PAYMENT FREQUENCY</span>
                    <span class="paymentValue" id="contractPaymentFreq">Monthly</span>
                  </div>
                </div>
              </section>

              <!-- Itemization of Amount Financed -->
              <section class="contractSection">
                <h5 class="contractSectionTitle">ITEMIZATION OF AMOUNT FINANCED</h5>
                <div class="itemizationTable">
                  <!-- Cash Price -->
                  <div class="itemRow itemRowBold">
                    <span class="itemLabel">SALE PRICE</span>
                    <span class="itemValue" id="contractCashPrice">$50,000.00</span>
                  </div>

                  <!-- Cash Down -->
                  <div class="itemRow itemRowBold">
                    <span class="itemLabel">LESS Cash Down</span>
                    <span class="itemValue" id="contractCashDown">$3,000.00</span>
                  </div>

                  <!-- Net Trade-In -->
                  <div class="itemRow itemRowBold">
                    <span class="itemLabel">LESS Net Trade-In</span>
                    <span class="itemValue" id="contractNetTrade">$2,000.00</span>
                  </div>
                  <div class="itemRow itemRowIndent">
                    <span class="itemLabel">Trade-In Allowance</span>
                    <span class="itemValue" id="contractTradeAllowance">$2,000.00</span>
                  </div>
                  <div class="itemRow itemRowIndent">
                    <span class="itemLabel">Less Pay-Off Made By Seller</span>
                    <span class="itemValue" id="contractTradePayoff">$0.00</span>
                  </div>

                  <!-- Unpaid Balance of Cash Price -->
                  <div class="itemRow itemRowBold">
                    <span class="itemLabel">UNPAID BALANCE OF SALE PRICE</span>
                    <span class="itemValue" id="contractUnpaidBalance">$45,000.00</span>
                  </div>

                  <!-- Other Charges -->
                  <div class="itemRow itemRowBold">
                    <span class="itemLabel">PLUS OTHER CHARGES</span>
                    <span class="itemValue" id="sumOtherCharges"></span>
                  </div>
                  <div class="itemRow itemRowIndent">
                    <span class="itemLabel">Total Dealer Fees</span>
                    <span class="itemValue" id="contractDealerFees">$799.00</span>
                  </div>
                  <div class="itemRow itemRowIndent">
                    <span class="itemLabel">Total Customer Add-ons</span>
                    <span class="itemValue" id="contractCustomerAddons">$0.00</span>
                  </div>
                  <div class="itemRow itemRowIndent">
                    <span class="itemLabel">Total Gov't Fees</span>
                    <span class="itemValue" id="contractGovtFees">$150.00</span>
                  </div>
                  <div class="itemRow itemRowIndent">
                    <span class="itemLabel">State Taxes</span>
                    <span class="itemValue" id="contractStateTax">$2,500.00</span>
                  </div>
                  <div class="itemRow itemRowIndent">
                    <span class="itemLabel">County Taxes</span>
                    <span class="itemValue" id="contractCountyTax">$50.00</span>
                  </div>

                  <!-- Amount Financed -->
                  <div class="itemRow itemRowBold itemRowTotal">
                    <span class="itemLabel">AMOUNT FINANCED</span>
                    <span class="itemValue" id="contractAmountFinanced2">$48,499.00</span>
                  </div>
                </div>
              </section>

              <!-- Cash Due at Signing -->
              <section class="contractSection">
                <div class="cashDueBox">
                  <div class="cashDueRow" id="contractCashToBuyerRow" style="display: none;">
                    <span class="cashDueLabel">CASH TO BUYER AT SIGNING</span>
                    <span class="cashDueValue contractCashToBuyer" id="contractCashToBuyer">$0.00</span>
                  </div>
                  <div class="cashDueRow">
                    <span class="cashDueLabel">CASH DUE AT SIGNING</span>
                    <span class="cashDueValue" id="contractCashDue">$1,500.00</span>
                  </div>
                </div>
                <div class="contractNote contractNetNote" id="contractNetNote" style="display: none;">
                  <strong id="contractNetLabel">NET AMOUNT:</strong>
                  <span id="contractNetAmount"></span>
                  <br>
                  <span id="contractNetExplanation"></span>
                </div>
              </section>
            </div>

            <footer class="modalActions">
              <button
                type="button"
                class="modalPrimary"
                id="submitOfferButton"
                title="Submit offer to dealer"
              >
                Submit
              </button>
              <button
                type="button"
                class="modalPrimary"
                id="printContractButton"
                title="Print contract summary"
              >
                Print
              </button>
              <button
                type="button"
                class="modalSecondary"
                data-contract-action="close"
              >
                Close
              </button>
            </footer>
          </div>
        </div>

        <!-- Toast Notification Container -->
        <div id="toastContainer" class="toastContainer"></div>

      </main>
    </body>
</html>
